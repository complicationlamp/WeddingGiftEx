<!doctype html>
<html>
<head>
    <title>Changing Info</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css"> <!-- load bootstrap css -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css"> <!-- load fontawesome -->
    <style>
        body        { padding-top:80px; margin:50px; display: contents; }
    </style>
</head>
<body>
<div class="container">

<!-- ================= -->
<!-- running Header for navigation -->
<!-- ================= -->

<header><% include partials/header.ejs %></header>

<div class="col-sm-6 col-sm-offset-3">

    <h1><span class="fa fa-sign-in"></span> Update Your Info</h1>

    <!-- show any messages that come back with authentication -->
    <% if (message.length > 0) { %>
        <div class="alert alert-danger"><%= message %></div>
    <% } %>

<!-- ===============================================================================
===============================================================================
NEED!!! SOME SORT OF CALL AJAX? TO GET THE ID NUMBERS & WE NEED TO NOT DELETE OTHER INFO ALREADY PUT IN
===============================================================================
=============================================================================== -->


    <!-- UPDATING INFO FORM -->
    <form action="/updateInfo" method="put">
        <div class="form-group">
            <label>Email (Required)</label>
            <input type="text" class="form-control" name="email">
        </div>
        <div class="form-group">
            <label>Password (Required)</label>
            <input type="password" class="form-control" name="password">
        </div>
        <div class="form-group">
            <label>Name</label>
            <input type="text" class="form-control" name="firstnamelastname">
        </div>
        <div class="form-group">
                <label>Location</label>
                <input type="text" class="form-control" name="whereareyoufrom">
        </div>
        <div class="form-group">
                <label>How do you know the Bride or Groom?</label>
                <input type="text" class="form-control" name="relationship">
        </div>
        <div class="form-group">
                <label>What unique local item are you bringing as a gift to exchange?</label>
                <input type="text" class="form-control" name="giftforex">
        </div>
        

        <button type="submit" class="btn btn-warning btn-lg">Update</button>
    </form>

    <hr>

    <p>Already have an account? <a href="/login">Login</a></p>
    <p>Or go <a href="/">home</a>.</p>

</div>
<script
			  src="https://code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
              crossorigin="anonymous"></script>

<script type="text/javascript">
    $("form").on("submit", function(e) {
        e.preventDefault();
        
        let toUpdate = {};

        $("form input").each(function(idx, input) {
        // input is a DOM node
        // each input has a unique name attribute
        
        // if value empty, stop this iteration
            if (input.value === '') { return; }
            toUpdate[input.name] = input.value;
        
        });
        // do AJAX using this new object
        console.log('inside update ejs', toUpdate)
        $.ajax({
        url: '/profile/5b149d2428ac2a7a8ed23bed',
        type: 'PUT',
        data: JSON.stringify(toUpdate),
        contentType: 'application/json'
        })
    });
</script>

</div>
</body>
</html>